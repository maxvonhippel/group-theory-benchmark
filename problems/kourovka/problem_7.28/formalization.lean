/-
Kourovka Notebook Problem 7.28 (S. I. Adian)

Prove that the periodic product of odd exponent n ≥ 665 of non-trivial groups F₁, ..., Fₖ
which do not contain involutions cannot be generated by less than k elements.

This would imply, on the basis of (S. I. Adian, Sov. Math. Doklady, 19, (1978), 910–913),
the existence of k-generated simple groups which cannot be generated by less than k elements,
for any k > 0.

The "periodic product" of exponent n of groups F₁, ..., Fₖ is defined as the quotient of the
free product F₁ * F₂ * ... * Fₖ by the normal closure of all n-th powers. This is a specific
construction in combinatorial group theory due to Adian.
-/

import Mathlib.GroupTheory.CoprodI
import Mathlib.GroupTheory.Finiteness
import Mathlib.GroupTheory.OrderOfElement
import Mathlib.GroupTheory.Exponent
import Mathlib.GroupTheory.Subgroup.Simple
import Mathlib.Data.Fin.Basic
import Mathlib.Data.Finset.Card

/--
A group has no involutions if it contains no elements of order 2.
-/
def NoInvolutions (G : Type*) [Group G] : Prop :=
  ∀ g : G, orderOf g ≠ 2

/--
A group G can be generated by at most n elements if there exists a generating set of cardinality ≤ n.
-/
def CanBeGeneratedBy (G : Type*) [Group G] (n : ℕ) : Prop :=
  ∃ S : Finset G, S.card ≤ n ∧ Subgroup.closure (S : Set G) = ⊤

/--
A group G requires at least n generators if it cannot be generated by fewer than n elements.
-/
def RequiresAtLeast (G : Type*) [Group G] (n : ℕ) : Prop :=
  ∀ S : Finset G, Subgroup.closure (S : Set G) = ⊤ → S.card ≥ n

/--
Axiomatized periodic product construction.

The periodic product B(n; F₁, ..., Fₖ) of groups F₁, ..., Fₖ with exponent n is defined
as the quotient of the free product F₁ * F₂ * ... * Fₖ by the normal closure of
{gⁿ : g ∈ F₁ * ... * Fₖ}.

This is NOT the same as simply taking the free product - it enforces that every element
in the resulting group has order dividing n.

We axiomatize this construction since it is not available in Mathlib.
-/
axiom PeriodicProduct (n : ℕ) (ι : Type*) (F : ι → Type*) [∀ i, Group (F i)] : Type*

axiom PeriodicProduct.instGroup {n : ℕ} {ι : Type*} {F : ι → Type*} [∀ i, Group (F i)] :
    Group (PeriodicProduct n ι F)

attribute [instance] PeriodicProduct.instGroup

/--
The periodic product has exponent dividing n (every element satisfies g^n = 1).
-/
axiom PeriodicProduct.exponent_dvd {n : ℕ} {ι : Type*} {F : ι → Type*} [∀ i, Group (F i)]
    (hn : 0 < n) : Monoid.exponent (PeriodicProduct n ι F) ∣ n

/--
There is a canonical homomorphism from each Fᵢ into the periodic product.
-/
axiom PeriodicProduct.of {n : ℕ} {ι : Type*} {F : ι → Type*} [∀ i, Group (F i)] (i : ι) :
    F i →* PeriodicProduct n ι F

/--
**Kourovka Problem 7.28** (S. I. Adian):

The periodic product of odd exponent n ≥ 665 of k non-trivial groups F₁, ..., Fₖ
which do not contain involutions cannot be generated by fewer than k elements.

The hypotheses are:
1. n is odd and n ≥ 665 (a technical condition from Adian's work on Burnside problems)
2. Each Fᵢ is non-trivial (has more than one element)
3. Each Fᵢ has no involutions (no elements of order 2)

The conclusion is that any generating set of the periodic product has at least k elements.
-/
theorem kourovka_7_28
    (n k : ℕ)
    (F : Fin k → Type*)
    [∀ i, Group (F i)]
    (hn_odd : Odd n)
    (hn_large : n ≥ 665)
    (hF_nontrivial : ∀ i, Nontrivial (F i))
    (hF_no_involutions : ∀ i, NoInvolutions (F i)) :
    RequiresAtLeast (PeriodicProduct n (Fin k) F) k := by
  sorry

/-!
## Corollary (mentioned in the problem)

The problem statement notes that this result would imply, based on Adian's 1978 paper,
the existence of k-generated simple groups which cannot be generated by fewer than k elements,
for any k > 0.
-/

/--
Consequence of Problem 7.28: For any k > 0, there exists a simple group that requires
exactly k generators (cannot be generated by fewer than k elements) and can be generated
by exactly k elements.
-/
theorem kourovka_7_28_corollary (k : ℕ) (hk : k > 0) :
    ∃ (G : Type) (_ : Group G) (_ : IsSimpleGroup G),
      CanBeGeneratedBy G k ∧ RequiresAtLeast G k := by
  sorry
